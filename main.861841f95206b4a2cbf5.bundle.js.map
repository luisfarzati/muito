{"version":3,"file":"main.861841f95206b4a2cbf5.bundle.js","sources":["webpack:///./src/components/Avatar/Avatar.tsx"],"sourcesContent":["import {\n  AvatarProps as MuiAvatarProps,\n  default as MuiAvatar\n} from \"@material-ui/core/Avatar\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport {\n  default as React,\n  FunctionComponent,\n  useEffect,\n  useState\n} from \"react\";\n\ntype AvatarProps = MuiAvatarProps & {\n  subject?: {\n    name: string;\n  };\n};\n\nfunction initials(name: string = \"\") {\n  const [first, ...rest] = name\n    .toUpperCase()\n    .trim()\n    .split(\" \");\n  const last = rest.pop() || \"\";\n  return `${first[0] || \" \"}${last[0] || \" \"}`.trim();\n}\n\nfunction toHsl(str = \"\", s = 50, l = 70) {\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  let h = hash % 360;\n  return `hsl(${h}, ${s}%, ${l}%)`;\n}\n\nconst styles = {\n  colorDefault: {\n    backgroundColor: \"inherit\"\n  }\n};\n\nconst useStyles = makeStyles(() => styles, { name: \"MuitoAvatar\" });\n\nconst Avatar: FunctionComponent<AvatarProps> = ({\n  src,\n  alt,\n  classes = {},\n  imgProps,\n  childrenClassName,\n  subject = { name: \"\" },\n  ...props\n}) => {\n  const [showImage, setShowImage] = useState(false);\n  const [showInitials, setShowInitials] = useState(false);\n\n  useEffect(() => {\n    async function load() {\n      const image = new Image();\n\n      if (Image.prototype.decode) {\n        image.src = src!;\n        try {\n          await image.decode();\n          setShowImage(true);\n        } catch (error) {\n          setShowInitials(true);\n        }\n      } else {\n        image.onload = () => setShowImage(true);\n        image.onerror = () => setShowInitials(true);\n        image.src = src!;\n      }\n    }\n\n    if (src) {\n      load();\n    } else if (subject) {\n      setShowInitials(true);\n    }\n  }, []);\n\n  const styles = useStyles();\n\n  return (\n    <MuiAvatar\n      classes={{\n        root: classes.root,\n        ...(showImage\n          ? { colorDefault: styles.colorDefault }\n          : { colorDefault: classes.colorDefault })\n      }}\n      style={\n        showImage || !subject.name\n          ? {}\n          : { backgroundColor: toHsl(subject.name) }\n      }\n      {...props}\n    >\n      {showImage && (\n        <img\n          src={src}\n          alt={alt}\n          className={`MuiAvatar-img ${classes.img || \"\"}`}\n          {...imgProps}\n        />\n      )}\n      {(showInitials && initials(subject.name)) || null}\n    </MuiAvatar>\n  );\n};\n\nexport default Avatar;\n"],"mappings":"AA2BA","sourceRoot":""}